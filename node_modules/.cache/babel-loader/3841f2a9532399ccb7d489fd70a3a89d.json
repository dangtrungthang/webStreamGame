{"ast":null,"code":"\"use strict\";\n/**\r\n * Animated.tsx\r\n *\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT license.\r\n *\r\n * Implements animated components for web version of ReactXP.\r\n */\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Easing = exports.interpolate = exports.createValue = exports.View = exports.TextInput = exports.Text = exports.Image = exports.parallel = exports.sequence = exports.timing = exports.InterpolatedValue = exports.Value = exports.Animation = void 0;\n\nvar React = require(\"react\");\n\nvar ReactDOM = require(\"react-dom\");\n\nvar AppConfig_1 = require(\"../common/AppConfig\");\n\nvar Easing_1 = require(\"../common/Easing\");\n\nexports.Easing = Easing_1.default;\n\nvar RX = require(\"../common/Interfaces\");\n\nvar executeTransition_1 = require(\"./animated/executeTransition\");\n\nvar Image_1 = require(\"./Image\");\n\nvar _ = require(\"./utils/lodashMini\");\n\nvar Styles_1 = require(\"./Styles\");\n\nvar Text_1 = require(\"./Text\");\n\nvar TextInput_1 = require(\"./TextInput\");\n\nvar View_1 = require(\"./View\"); // Animated Css Property Units - check /common/Types for the list of available\n// css animated properties\n\n\nvar animatedPropUnits = {\n  // AnimatedFlexboxStyleRules\n  height: 'px',\n  width: 'px',\n  left: 'px',\n  right: 'px',\n  top: 'px',\n  bottom: 'px',\n  // AnimatedTransformStyleRules\n  perspective: '',\n  rotate: 'deg',\n  rotateX: 'deg',\n  rotateY: 'deg',\n  rotateZ: 'deg',\n  scale: '',\n  scaleX: '',\n  scaleY: '',\n  scaleZ: '',\n  translateX: 'px',\n  translateY: 'px',\n  skewX: '',\n  skewY: '',\n  // AnimatedViewAndImageCommonStyleRules\n  backgroundColor: '',\n  opacity: '',\n  borderRadius: 'px',\n  // AnimatedTextStyleRules\n  color: '',\n  fontSize: 'px'\n}; // Every Animation subclass should extend this.\n\nvar Animation =\n/** @class */\nfunction () {\n  function Animation() {}\n\n  return Animation;\n}();\n\nexports.Animation = Animation; // The animated value object\n\nvar Value =\n/** @class */\nfunction (_super) {\n  __extends(Value, _super); // Initializes the object with the defaults and assigns the id for the animated value.\n\n\n  function Value(value) {\n    var _this = _super.call(this, value) || this;\n\n    _this._value = value;\n    _this._listeners = [];\n    return _this;\n  } // Gets the current animated value (this gets updates after animation concludes)\n\n\n  Value.prototype._getInputValue = function () {\n    return this._value;\n  };\n\n  Value.prototype._getOutputValue = function () {\n    return this._getInterpolatedValue(this._value);\n  };\n\n  Value.prototype._getInterpolatedValue = function (inputVal) {\n    return inputVal;\n  };\n\n  Value.prototype._isInterpolated = function () {\n    return false;\n  };\n\n  Value.prototype.interpolate = function (config) {\n    return new InterpolatedValue(config, this);\n  }; // Updates a value in this animated reference.\n\n\n  Value.prototype.setValue = function (value) {\n    var _this = this;\n\n    if (value === undefined) {\n      throw new Error('An invalid value was passed into setvalue in the animated value api');\n    } // If value the same, do nothing.\n\n\n    if (value === this._value) {\n      return;\n    }\n\n    this._value = value; // Notify subscribers about the new value.\n\n    _.each(this._listeners, function (listener) {\n      return listener.setValue(_this, value);\n    });\n  }; // Add listener for when the value gets updated.\n\n\n  Value.prototype._addListener = function (listenerToAdd) {\n    if (this._listeners.indexOf(listenerToAdd) < 0) {\n      this._listeners.push(listenerToAdd);\n    }\n  }; // Remove a specific listner.\n\n\n  Value.prototype._removeListener = function (listenerToRemove) {\n    this._listeners = _.filter(this._listeners, function (listener) {\n      return listener !== listenerToRemove;\n    });\n  }; // Remove all listeners.\n\n\n  Value.prototype._removeAllListeners = function () {\n    this._listeners = [];\n  }; // Start a specific animation.\n\n\n  Value.prototype._startTransition = function (toValue, duration, easing, delay, onEnd) {\n    var _this = this; // If there are no listeners, the app probably has a bug where it's\n    // starting an animation before the associated element is mounted.\n    // Complete the animation immediately by updating to the end value\n    // and caling the onEnd callback.\n\n\n    if (this._listeners.length === 0) {\n      this._updateFinalValue(toValue);\n\n      if (onEnd) {\n        onEnd({\n          finished: false\n        });\n      }\n\n      return;\n    } // Only call onEnd once for a series of listeners.\n\n\n    var onEndCalled = false;\n\n    var onEndWrapper = function (result) {\n      if (onEndCalled) {\n        return;\n      }\n\n      onEndCalled = true;\n      onEnd(result);\n    };\n\n    _.each(this._listeners, function (listener) {\n      listener.startTransition(_this, _this._getOutputValue(), _this._getInterpolatedValue(toValue), duration, easing, delay, onEndWrapper);\n    });\n  }; // Stop animation.\n\n\n  Value.prototype._stopTransition = function () {\n    var _this = this;\n\n    _.each(this._listeners, function (listener) {\n      var updatedValue = listener.stopTransition(_this);\n\n      if (updatedValue !== undefined) {\n        _this._updateFinalValue(updatedValue);\n      }\n    });\n  }; // After an animation is stopped or completed, updates\n  // the final value.\n\n\n  Value.prototype._updateFinalValue = function (value) {\n    this.setValue(value);\n  };\n\n  return Value;\n}(RX.Types.AnimatedValue);\n\nexports.Value = Value;\n\nvar InterpolatedValue =\n/** @class */\nfunction (_super) {\n  __extends(InterpolatedValue, _super);\n\n  function InterpolatedValue(_config, rootValue) {\n    var _this = _super.call(this, rootValue._getOutputValue()) || this;\n\n    _this._config = _config;\n\n    if (!_this._config || !_this._config.inputRange || !_this._config.outputRange || _this._config.inputRange.length < 2 || _this._config.outputRange.length < 2 || _this._config.inputRange.length !== _this._config.outputRange.length) {\n      throw new Error('The interpolation config is invalid. Input and output arrays must be same length.');\n    }\n\n    var newInterpolationConfig = {};\n\n    _.each(_this._config.inputRange, function (key, index) {\n      newInterpolationConfig[key] = _this._config.outputRange[index];\n    });\n\n    _this._interpolationConfig = newInterpolationConfig;\n\n    rootValue._addListener({\n      setValue: function (valueObject, newValue) {\n        _this.setValue(valueObject._getOutputValue());\n      },\n      startTransition: function (valueObject, from, toValue, duration, easing, delay, onEnd) {\n        _this._startTransition(toValue, duration, easing, delay, onEnd);\n      },\n      stopTransition: function (valueObject) {\n        _this._stopTransition();\n\n        return undefined;\n      }\n    });\n\n    return _this;\n  }\n\n  InterpolatedValue.prototype._startTransition = function (toValue, duration, easing, delay, onEnd) {\n    // This API doesn't currently support more than two elements in the\n    // interpolation array. Supporting this in the web would require the\n    // use of JS-driven animations or keyframes, both of which are prohibitively\n    // expensive from a performance and responsiveness perspective.\n    if (this._config.inputRange.length !== 2) {\n      if (AppConfig_1.default.isDevelopmentMode()) {\n        console.log('Web implementation of interpolate API currently supports only two interpolation values.');\n      }\n    }\n\n    _super.prototype._startTransition.call(this, toValue, duration, easing, delay, onEnd);\n  };\n\n  InterpolatedValue.prototype._convertValueToNumeric = function (inputVal) {\n    if (_.isNumber(inputVal)) {\n      return inputVal;\n    }\n\n    return parseInt(inputVal, 10);\n  };\n\n  InterpolatedValue.prototype._addUnitsToNumericValue = function (value, templateValue) {\n    if (_.isNumber(templateValue)) {\n      return value;\n    } // Does the template contain any of the common units?\n\n\n    var templateString = templateValue;\n    var commonUnits = ['deg', 'grad', 'rad'];\n\n    for (var _i = 0, commonUnits_1 = commonUnits; _i < commonUnits_1.length; _i++) {\n      var unit = commonUnits_1[_i];\n\n      if (templateString.indexOf(unit) > 0) {\n        return value.toString() + unit;\n      }\n    }\n\n    return value;\n  };\n\n  InterpolatedValue.prototype._getInterpolatedValue = function (inputVal) {\n    var _this = this;\n\n    if (!this._interpolationConfig) {\n      throw new Error('There is no interpolation config but one is required');\n    }\n\n    var numericInputValue = this._convertValueToNumeric(inputVal);\n\n    var outputValues = this._config.outputRange.map(function (value) {\n      return _this._convertValueToNumeric(value);\n    });\n\n    if (this._interpolationConfig[numericInputValue]) {\n      return this._interpolationConfig[numericInputValue];\n    }\n\n    if (inputVal < this._config.inputRange[0]) {\n      return outputValues[0];\n    }\n\n    for (var i = 1; i < this._config.inputRange.length; i++) {\n      if (inputVal < this._config.inputRange[i]) {\n        var ratio = (numericInputValue - this._config.inputRange[i - 1]) / (this._config.inputRange[i] - this._config.inputRange[i - 1]);\n        return this._addUnitsToNumericValue(this._config.outputRange[i] * ratio + this._config.outputRange[i - 1] * (1 - ratio), inputVal);\n      }\n    }\n\n    return this._addUnitsToNumericValue(outputValues[this._config.inputRange.length - 1], inputVal);\n  };\n\n  InterpolatedValue.prototype._isInterpolated = function () {\n    return true;\n  };\n\n  return InterpolatedValue;\n}(Value);\n\nexports.InterpolatedValue = InterpolatedValue;\n\nexports.timing = function (value, config) {\n  if (!value || !config) {\n    throw new Error('Timing animation requires value and config');\n  }\n\n  var stopLooping = false;\n  return {\n    start: function (onEnd) {\n      var animate = function () {\n        if (config.loop) {\n          value.setValue(config.loop.restartFrom);\n        }\n\n        var easing = config.easing || Easing_1.default.Default();\n        var duration = config.duration !== undefined ? config.duration : 500;\n        var delay = config.delay || 0;\n\n        value._startTransition(config.toValue, duration, easing.cssName, delay, function (result) {\n          // Restart the loop?\n          if (config.loop && !stopLooping) {\n            animate();\n          } else {\n            value._updateFinalValue(config.toValue);\n          }\n\n          if (onEnd) {\n            onEnd(result);\n          }\n        });\n      }; // Trigger animation loop\n\n\n      animate();\n    },\n    stop: function () {\n      stopLooping = true;\n\n      value._stopTransition();\n    }\n  };\n};\n\nexports.sequence = function (animations) {\n  if (!animations) {\n    throw new Error('Sequence animation requires a list of animations');\n  }\n\n  var hasBeenStopped = false;\n  var doneCount = 0;\n  var result = {\n    start: function (onEnd) {\n      if (!animations || animations.length === 0) {\n        throw new Error('No animations were passed to the animated sequence API');\n      }\n\n      var executeNext = function () {\n        doneCount++;\n        var isFinished = doneCount === animations.length;\n\n        if (hasBeenStopped || isFinished) {\n          doneCount = 0;\n          hasBeenStopped = false;\n\n          if (onEnd) {\n            onEnd({\n              finished: isFinished\n            });\n          }\n\n          return;\n        }\n\n        animations[doneCount].start(executeNext);\n      };\n\n      animations[doneCount].start(executeNext);\n    },\n    stop: function () {\n      if (doneCount < animations.length) {\n        doneCount = 0;\n        hasBeenStopped = true;\n        animations[doneCount].stop();\n      }\n    }\n  };\n  return result;\n};\n\nexports.parallel = function (animations) {\n  if (!animations) {\n    throw new Error('Parallel animation requires a list of animations');\n  } // Variable to make sure we only call stop() at most once\n\n\n  var hasBeenStopped = false;\n  var doneCount = 0;\n  var result = {\n    start: function (onEnd) {\n      if (!animations || animations.length === 0) {\n        throw new Error('No animations were passed to the animated parallel API');\n      } // Walk through animations and start all as soon as possible.\n\n\n      animations.forEach(function (animation, id) {\n        animation.start(function (animationResult) {\n          doneCount++;\n          var isFinished = doneCount === animations.length;\n\n          if (hasBeenStopped || isFinished) {\n            doneCount = 0;\n            hasBeenStopped = false;\n\n            if (onEnd) {\n              onEnd({\n                finished: isFinished\n              });\n            }\n\n            return;\n          }\n        });\n      });\n    },\n    stop: function () {\n      doneCount = 0;\n      hasBeenStopped = true;\n      animations.forEach(function (animation) {\n        animation.stop();\n      });\n    }\n  };\n  return result;\n}; // Function for creating wrapper AnimatedComponent around passed in component\n\n\nfunction createAnimatedComponent(Component) {\n  var AnimatedComponentGenerated =\n  /** @class */\n  function (_super) {\n    __extends(AnimatedComponentGenerated, _super);\n\n    function AnimatedComponentGenerated(props) {\n      var _this = _super.call(this, props) || this;\n\n      _this._mountedComponent = null;\n\n      _this._onMount = function (component) {\n        _this._mountedComponent = component;\n      };\n\n      _this._animatedAttributes = {};\n      _this._animatedTransforms = {};\n\n      _this._updateStyles(props);\n\n      return _this;\n    }\n\n    AnimatedComponentGenerated.prototype.setNativeProps = function (props) {\n      if (AppConfig_1.default.isDevelopmentMode()) {\n        console.error('setNativeProps not supported on web');\n      }\n    };\n\n    AnimatedComponentGenerated.prototype.UNSAFE_componentWillReceiveProps = function (props) {\n      this._updateStyles(props);\n    };\n\n    AnimatedComponentGenerated.prototype.setValue = function (valueObject, newValue) {\n      // We should never get here if the component isn't mounted,\n      // but we'll add this additional protection.\n      if (!this._mountedComponent) {\n        return;\n      }\n\n      var attrib = this._findAnimatedAttributeByValue(this._animatedAttributes, valueObject);\n\n      if (attrib) {\n        var domNode = this._getDomNode();\n\n        if (domNode) {\n          var cssValue = this._generateCssAttributeValue(attrib, valueObject._getOutputValue());\n\n          domNode.style[attrib] = cssValue;\n        }\n\n        return;\n      }\n\n      var transform = this._findAnimatedAttributeByValue(this._animatedTransforms, valueObject);\n\n      if (transform) {\n        var domNode = this._getDomNode();\n\n        if (domNode) {\n          domNode.style.transform = this._generateCssTransformList(true);\n        }\n      }\n    };\n\n    AnimatedComponentGenerated.prototype.startTransition = function (valueObject, fromValue, toValue, duration, easing, delay, onEnd) {\n      // We should never get here if the component isn't mounted,\n      // but we'll add this additional protection.\n      if (!this._mountedComponent) {\n        return;\n      }\n\n      var updateTransition = false;\n\n      var attrib = this._findAnimatedAttributeByValue(this._animatedAttributes, valueObject);\n\n      if (attrib) {\n        if (this._animatedAttributes[attrib].activeTransition) {\n          if (AppConfig_1.default.isDevelopmentMode()) {\n            console.error('Animation started while animation was already pending');\n          }\n        }\n\n        this._animatedAttributes[attrib].activeTransition = {\n          property: Styles_1.default.convertJsToCssStyle(attrib),\n          from: this._generateCssAttributeValue(attrib, fromValue),\n          to: this._generateCssAttributeValue(attrib, toValue),\n          duration: duration,\n          timing: easing,\n          delay: delay,\n          toValue: toValue,\n          onEnd: onEnd\n        };\n        updateTransition = true;\n      }\n\n      var transform = this._findAnimatedAttributeByValue(this._animatedTransforms, valueObject);\n\n      if (transform) {\n        if (this._animatedTransforms[transform].activeTransition) {\n          if (AppConfig_1.default.isDevelopmentMode()) {\n            console.error('Animation started while animation was already pending');\n          }\n        }\n\n        this._animatedTransforms[transform].activeTransition = {\n          property: transform,\n          from: fromValue,\n          to: toValue,\n          duration: duration,\n          timing: easing,\n          delay: delay,\n          toValue: toValue,\n          onEnd: onEnd\n        };\n        updateTransition = true;\n      }\n\n      if (updateTransition) {\n        this._updateTransition();\n      }\n    }; // Stops a pending transition, returning the value at the current time.\n\n\n    AnimatedComponentGenerated.prototype.stopTransition = function (valueObject) {\n      // We should never get here if the component isn't mounted,\n      // but we'll add this additional protection.\n      if (!this._mountedComponent) {\n        return;\n      }\n\n      var partialValue;\n      var stoppedTransition;\n      var updateTransition = false;\n\n      var attrib = this._findAnimatedAttributeByValue(this._animatedAttributes, valueObject);\n\n      if (attrib) {\n        var activeTransition = this._animatedAttributes[attrib].activeTransition;\n\n        if (activeTransition) {\n          partialValue = activeTransition.toValue; // We don't currently support updating to an intermediate\n          // value for interpolated values because this would involve\n          // mapping the interpolated value in reverse. Instead, we'll\n          // simply update it to the \"toValue\".\n\n          if (!valueObject._isInterpolated()) {\n            var domNode = this._getDomNode();\n\n            if (domNode) {\n              var computedStyle = window.getComputedStyle(domNode, undefined);\n\n              if (computedStyle && computedStyle[attrib]) {\n                partialValue = computedStyle[attrib];\n              }\n            }\n          }\n\n          stoppedTransition = this._animatedAttributes[attrib].activeTransition;\n          delete this._animatedAttributes[attrib].activeTransition;\n          updateTransition = true;\n        }\n      } else {\n        var transform = this._findAnimatedAttributeByValue(this._animatedTransforms, valueObject);\n\n        if (transform) {\n          var activeTransition = this._animatedTransforms[transform].activeTransition;\n\n          if (activeTransition) {\n            // We don't currently support updating to an intermediate value\n            // for transform values. This is because getComputedStyle\n            // returns a transform matrix for 'transform'. To implement this, we'd\n            // need to convert the matrix back to a rotation, scale, etc.\n            partialValue = activeTransition.toValue;\n            stoppedTransition = this._animatedTransforms[transform].activeTransition;\n            delete this._animatedTransforms[transform].activeTransition;\n            updateTransition = true;\n          }\n        }\n      }\n\n      if (stoppedTransition && stoppedTransition.onEnd) {\n        stoppedTransition.onEnd({\n          finished: false\n        });\n      }\n\n      if (updateTransition) {\n        this._updateTransition();\n      }\n\n      return partialValue;\n    };\n\n    AnimatedComponentGenerated.prototype._getDomNode = function () {\n      return ReactDOM.findDOMNode(this._mountedComponent);\n    }; // Looks for the specified value object in the specified map. Returns\n    // the key for the map (i.e. the attribute name) if found.\n\n\n    AnimatedComponentGenerated.prototype._findAnimatedAttributeByValue = function (map, valueObj) {\n      var keys = _.keys(map);\n\n      var index = _.findIndex(keys, function (key) {\n        return map[key].valueObject === valueObj;\n      });\n\n      return index >= 0 ? keys[index] : undefined;\n    }; // Updates the \"transform\" CSS attribute for the element to reflect all\n    // active transitions.\n\n\n    AnimatedComponentGenerated.prototype._updateTransition = function () {\n      var _this = this; // We should never get here if the component isn't mounted,\n      // but we'll add this additional protection.\n\n\n      if (!this._mountedComponent) {\n        return;\n      }\n\n      var activeTransitions = [];\n\n      _.each(this._animatedAttributes, function (attrib) {\n        if (attrib.activeTransition) {\n          activeTransitions.push(attrib.activeTransition);\n        }\n      }); // If there are any transform transitions, we need to combine\n      // these into a single transition. That means we can't specify\n      // different durations, delays or easing functions for each. That's\n      // an unfortunate limitation of CSS.\n\n\n      var keys = _.keys(this._animatedTransforms);\n\n      var index = _.findIndex(keys, function (key) {\n        return !!_this._animatedTransforms[key].activeTransition;\n      });\n\n      if (index >= 0) {\n        var transformTransition = this._animatedTransforms[keys[index]].activeTransition;\n        activeTransitions.push({\n          property: 'transform',\n          from: this._generateCssTransformList(false),\n          to: this._generateCssTransformList(true),\n          duration: transformTransition.duration,\n          timing: transformTransition.timing,\n          delay: transformTransition.delay\n        });\n      }\n\n      if (activeTransitions.length > 0) {\n        var domNode = this._getDomNode();\n\n        if (domNode) {\n          executeTransition_1.executeTransition(domNode, activeTransitions, function () {\n            // Clear all of the active transitions and invoke the onEnd callbacks.\n            var completeTransitions = [];\n\n            _.each(_this._animatedAttributes, function (attrib) {\n              if (attrib.activeTransition) {\n                completeTransitions.push(attrib.activeTransition);\n                delete attrib.activeTransition;\n              }\n            });\n\n            _.each(_this._animatedTransforms, function (transform) {\n              if (transform.activeTransition) {\n                completeTransitions.push(transform.activeTransition);\n                delete transform.activeTransition;\n              }\n            });\n\n            _.each(completeTransitions, function (transition) {\n              if (transition.onEnd) {\n                transition.onEnd({\n                  finished: true\n                });\n              }\n            });\n          });\n        }\n      }\n    }; // Generates the CSS value for the specified attribute given\n    // an animated value object.\n\n\n    AnimatedComponentGenerated.prototype._generateCssAttributeValue = function (attrib, newValue) {\n      // If the value is a raw number, append the default units.\n      // If it's a string, we assume the caller has specified the units.\n      if (typeof newValue === 'number') {\n        newValue = newValue + animatedPropUnits[attrib];\n      }\n\n      return newValue;\n    };\n\n    AnimatedComponentGenerated.prototype._generateCssTransformValue = function (transform, newValue) {\n      // If the value is a raw number, append the default units.\n      // If it's a string, we assume the caller has specified the units.\n      if (typeof newValue === 'number') {\n        newValue = newValue + animatedPropUnits[transform];\n      }\n\n      return newValue;\n    }; // Regenerates the list of transforms, combining all static and animated transforms.\n\n\n    AnimatedComponentGenerated.prototype._generateCssTransformList = function (useActiveValues) {\n      var _this = this;\n\n      var transformList = [];\n\n      _.each(this._staticTransforms, function (value, transform) {\n        transformList.push(transform + '(' + value + ')');\n      });\n\n      _.each(this._animatedTransforms, function (value, transform) {\n        var newValue = useActiveValues && value.activeTransition ? value.activeTransition.to : value.valueObject._getOutputValue();\n        transformList.push(transform + '(' + _this._generateCssTransformValue(transform, newValue) + ')');\n      });\n\n      return transformList.join(' ');\n    }; // Typing of `any` on StyleRuleSet isn't desirable, but there's not accurate typings that can be used to represent\n    // our merging of web/RX styles here here\n\n\n    AnimatedComponentGenerated.prototype._updateStyles = function (props) {\n      var _this = this;\n\n      this._propsWithoutStyle = _.omit(props, 'style');\n      var rawStyles = Styles_1.default.combine(props.style || {});\n      this._processedStyle = {};\n      var newAnimatedAttributes = {};\n\n      for (var attrib in rawStyles) {\n        // Handle transforms separately.\n        if (attrib === 'staticTransforms' || attrib === 'animatedTransforms') {\n          continue;\n        } // Is this a dynamic (animated) value?\n\n\n        if (rawStyles[attrib] instanceof Value) {\n          var valueObj = rawStyles[attrib];\n          this._processedStyle[attrib] = this._generateCssAttributeValue(attrib, valueObj._getOutputValue());\n          newAnimatedAttributes[attrib] = valueObj;\n        } else {\n          // Copy the static style value.\n          this._processedStyle[attrib] = rawStyles[attrib];\n        }\n      } // Handle transforms, which require special processing because they need to\n      // be combined into a single 'transform' CSS attribute.\n\n\n      this._staticTransforms = rawStyles.staticTransforms || {};\n      var newAnimatedTransforms = rawStyles.animatedTransforms || {}; // Update this._animatedAttributes and this._animatedTransforms so they match\n      // the updated style.\n      // Remove any previous animated attributes that are no longer present\n      // or associated with different value objects.\n\n      _.each(this._animatedAttributes, function (value, attrib) {\n        if (!newAnimatedAttributes[attrib] || newAnimatedAttributes[attrib] !== value.valueObject) {\n          if (value.activeTransition) {\n            if (AppConfig_1.default.isDevelopmentMode()) {\n              console.error('Animated style attribute removed while the animation was active');\n            }\n          }\n\n          value.valueObject._removeListener(_this);\n\n          delete _this._animatedAttributes[attrib];\n        }\n      }); // Add new animated attributes.\n\n\n      _.each(newAnimatedAttributes, function (value, attrib) {\n        if (!_this._animatedAttributes[attrib]) {\n          _this._animatedAttributes[attrib] = {\n            valueObject: value\n          };\n\n          if (_this._mountedComponent) {\n            value._addListener(_this);\n          }\n        }\n      }); // Remove any previous animated transforms that are no longer present\n      // or associated with different value objects.\n\n\n      _.each(this._animatedTransforms, function (value, transform) {\n        if (!newAnimatedTransforms[transform] || newAnimatedTransforms[transform] !== value.valueObject) {\n          if (value.activeTransition) {\n            if (AppConfig_1.default.isDevelopmentMode()) {\n              console.warn('Should not remove an animated transform attribute while the animation is active');\n            }\n          }\n\n          value.valueObject._removeListener(_this);\n\n          delete _this._animatedTransforms[transform];\n        }\n      }); // Add new animated transforms.\n\n\n      _.each(newAnimatedTransforms, function (value, transform) {\n        if (!_this._animatedTransforms[transform]) {\n          _this._animatedTransforms[transform] = {\n            valueObject: value\n          };\n\n          if (_this._mountedComponent) {\n            value._addListener(_this);\n          }\n        }\n      }); // Update the transform attribute in this._processedStyle.\n\n\n      var transformList = this._generateCssTransformList(true);\n\n      if (transformList) {\n        this._processedStyle.transform = transformList;\n      }\n    };\n\n    AnimatedComponentGenerated.prototype.componentDidMount = function () {\n      var _this = this;\n\n      _.each(this._animatedAttributes, function (value) {\n        value.valueObject._addListener(_this);\n      });\n\n      _.each(this._animatedTransforms, function (value) {\n        value.valueObject._addListener(_this);\n      });\n    };\n\n    AnimatedComponentGenerated.prototype.componentWillUnmount = function () {\n      var _this = this;\n\n      _.each(this._animatedAttributes, function (value) {\n        value.valueObject._removeListener(_this);\n      });\n\n      this._animatedAttributes = {};\n\n      _.each(this._animatedTransforms, function (value) {\n        value.valueObject._removeListener(_this);\n      });\n\n      this._animatedTransforms = {};\n    };\n\n    AnimatedComponentGenerated.prototype.focus = function () {\n      if (this._mountedComponent && this._mountedComponent.focus) {\n        this._mountedComponent.focus();\n      }\n    };\n\n    AnimatedComponentGenerated.prototype.requestFocus = function () {\n      if (this._mountedComponent && this._mountedComponent.requestFocus) {\n        this._mountedComponent.requestFocus();\n      }\n    };\n\n    AnimatedComponentGenerated.prototype.blur = function () {\n      if (this._mountedComponent && this._mountedComponent.blur) {\n        this._mountedComponent.blur();\n      }\n    };\n\n    AnimatedComponentGenerated.prototype.setFocusRestricted = function (restricted) {\n      if (this._mountedComponent && this._mountedComponent.setFocusRestricted) {\n        this._mountedComponent.setFocusRestricted(restricted);\n      }\n    };\n\n    AnimatedComponentGenerated.prototype.setFocusLimited = function (limited) {\n      if (this._mountedComponent && this._mountedComponent.setFocusLimited) {\n        this._mountedComponent.setFocusLimited(limited);\n      }\n    };\n\n    AnimatedComponentGenerated.prototype.render = function () {\n      return React.createElement(Component, __assign({\n        style: this._processedStyle\n      }, this._propsWithoutStyle, {\n        ref: this._onMount\n      }), this.props.children);\n    }; // Update the component's display name for easy debugging in react devtools extension\n\n\n    AnimatedComponentGenerated.displayName = \"Animated.\" + (Component.displayName || Component.name || 'Component');\n    return AnimatedComponentGenerated;\n  }(React.Component);\n\n  return AnimatedComponentGenerated;\n}\n\nexports.Image = createAnimatedComponent(Image_1.default);\nexports.Text = createAnimatedComponent(Text_1.default);\nexports.TextInput = createAnimatedComponent(TextInput_1.default);\nexports.View = createAnimatedComponent(View_1.default);\n\nexports.createValue = function (initialValue) {\n  return new Value(initialValue);\n};\n\nexports.interpolate = function (value, inputRange, outputRange) {\n  return value.interpolate({\n    inputRange: inputRange,\n    outputRange: outputRange\n  });\n};","map":{"version":3,"sources":["/Users/trungthang/webStreamGame/webStreamGame/node_modules/react-ult/dist/web/Animated.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","defineProperty","exports","value","Easing","interpolate","createValue","View","TextInput","Text","Image","parallel","sequence","timing","InterpolatedValue","Value","Animation","React","require","ReactDOM","AppConfig_1","Easing_1","default","RX","executeTransition_1","Image_1","_","Styles_1","Text_1","TextInput_1","View_1","animatedPropUnits","height","width","left","right","top","bottom","perspective","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","translateX","translateY","skewX","skewY","backgroundColor","opacity","borderRadius","color","fontSize","_super","_this","_value","_listeners","_getInputValue","_getOutputValue","_getInterpolatedValue","inputVal","_isInterpolated","config","setValue","undefined","Error","each","listener","_addListener","listenerToAdd","indexOf","push","_removeListener","listenerToRemove","filter","_removeAllListeners","_startTransition","toValue","duration","easing","delay","onEnd","_updateFinalValue","finished","onEndCalled","onEndWrapper","result","startTransition","_stopTransition","updatedValue","stopTransition","Types","AnimatedValue","_config","rootValue","inputRange","outputRange","newInterpolationConfig","key","index","_interpolationConfig","valueObject","newValue","from","isDevelopmentMode","console","log","_convertValueToNumeric","isNumber","parseInt","_addUnitsToNumericValue","templateValue","templateString","commonUnits","_i","commonUnits_1","unit","toString","numericInputValue","outputValues","map","ratio","stopLooping","start","animate","loop","restartFrom","Default","cssName","stop","animations","hasBeenStopped","doneCount","executeNext","isFinished","forEach","animation","id","animationResult","createAnimatedComponent","Component","AnimatedComponentGenerated","props","_mountedComponent","_onMount","component","_animatedAttributes","_animatedTransforms","_updateStyles","setNativeProps","error","UNSAFE_componentWillReceiveProps","attrib","_findAnimatedAttributeByValue","domNode","_getDomNode","cssValue","_generateCssAttributeValue","style","transform","_generateCssTransformList","fromValue","updateTransition","activeTransition","property","convertJsToCssStyle","to","_updateTransition","partialValue","stoppedTransition","computedStyle","window","getComputedStyle","findDOMNode","valueObj","keys","findIndex","activeTransitions","transformTransition","executeTransition","completeTransitions","transition","_generateCssTransformValue","useActiveValues","transformList","_staticTransforms","join","_propsWithoutStyle","omit","rawStyles","combine","_processedStyle","newAnimatedAttributes","staticTransforms","newAnimatedTransforms","animatedTransforms","warn","componentDidMount","componentWillUnmount","focus","requestFocus","blur","setFocusRestricted","restricted","setFocusLimited","limited","render","createElement","ref","children","displayName","name","initialValue"],"mappings":"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","sourcesContent":["\"use strict\";\r\n/**\r\n * Animated.tsx\r\n *\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT license.\r\n *\r\n * Implements animated components for web version of ReactXP.\r\n */\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Easing = exports.interpolate = exports.createValue = exports.View = exports.TextInput = exports.Text = exports.Image = exports.parallel = exports.sequence = exports.timing = exports.InterpolatedValue = exports.Value = exports.Animation = void 0;\r\nvar React = require(\"react\");\r\nvar ReactDOM = require(\"react-dom\");\r\nvar AppConfig_1 = require(\"../common/AppConfig\");\r\nvar Easing_1 = require(\"../common/Easing\");\r\nexports.Easing = Easing_1.default;\r\nvar RX = require(\"../common/Interfaces\");\r\nvar executeTransition_1 = require(\"./animated/executeTransition\");\r\nvar Image_1 = require(\"./Image\");\r\nvar _ = require(\"./utils/lodashMini\");\r\nvar Styles_1 = require(\"./Styles\");\r\nvar Text_1 = require(\"./Text\");\r\nvar TextInput_1 = require(\"./TextInput\");\r\nvar View_1 = require(\"./View\");\r\n// Animated Css Property Units - check /common/Types for the list of available\r\n// css animated properties\r\nvar animatedPropUnits = {\r\n    // AnimatedFlexboxStyleRules\r\n    height: 'px',\r\n    width: 'px',\r\n    left: 'px',\r\n    right: 'px',\r\n    top: 'px',\r\n    bottom: 'px',\r\n    // AnimatedTransformStyleRules\r\n    perspective: '',\r\n    rotate: 'deg',\r\n    rotateX: 'deg',\r\n    rotateY: 'deg',\r\n    rotateZ: 'deg',\r\n    scale: '',\r\n    scaleX: '',\r\n    scaleY: '',\r\n    scaleZ: '',\r\n    translateX: 'px',\r\n    translateY: 'px',\r\n    skewX: '',\r\n    skewY: '',\r\n    // AnimatedViewAndImageCommonStyleRules\r\n    backgroundColor: '',\r\n    opacity: '',\r\n    borderRadius: 'px',\r\n    // AnimatedTextStyleRules\r\n    color: '',\r\n    fontSize: 'px',\r\n};\r\n// Every Animation subclass should extend this.\r\nvar Animation = /** @class */ (function () {\r\n    function Animation() {\r\n    }\r\n    return Animation;\r\n}());\r\nexports.Animation = Animation;\r\n// The animated value object\r\nvar Value = /** @class */ (function (_super) {\r\n    __extends(Value, _super);\r\n    // Initializes the object with the defaults and assigns the id for the animated value.\r\n    function Value(value) {\r\n        var _this = _super.call(this, value) || this;\r\n        _this._value = value;\r\n        _this._listeners = [];\r\n        return _this;\r\n    }\r\n    // Gets the current animated value (this gets updates after animation concludes)\r\n    Value.prototype._getInputValue = function () {\r\n        return this._value;\r\n    };\r\n    Value.prototype._getOutputValue = function () {\r\n        return this._getInterpolatedValue(this._value);\r\n    };\r\n    Value.prototype._getInterpolatedValue = function (inputVal) {\r\n        return inputVal;\r\n    };\r\n    Value.prototype._isInterpolated = function () {\r\n        return false;\r\n    };\r\n    Value.prototype.interpolate = function (config) {\r\n        return new InterpolatedValue(config, this);\r\n    };\r\n    // Updates a value in this animated reference.\r\n    Value.prototype.setValue = function (value) {\r\n        var _this = this;\r\n        if (value === undefined) {\r\n            throw new Error('An invalid value was passed into setvalue in the animated value api');\r\n        }\r\n        // If value the same, do nothing.\r\n        if (value === this._value) {\r\n            return;\r\n        }\r\n        this._value = value;\r\n        // Notify subscribers about the new value.\r\n        _.each(this._listeners, function (listener) { return listener.setValue(_this, value); });\r\n    };\r\n    // Add listener for when the value gets updated.\r\n    Value.prototype._addListener = function (listenerToAdd) {\r\n        if (this._listeners.indexOf(listenerToAdd) < 0) {\r\n            this._listeners.push(listenerToAdd);\r\n        }\r\n    };\r\n    // Remove a specific listner.\r\n    Value.prototype._removeListener = function (listenerToRemove) {\r\n        this._listeners = _.filter(this._listeners, function (listener) { return listener !== listenerToRemove; });\r\n    };\r\n    // Remove all listeners.\r\n    Value.prototype._removeAllListeners = function () {\r\n        this._listeners = [];\r\n    };\r\n    // Start a specific animation.\r\n    Value.prototype._startTransition = function (toValue, duration, easing, delay, onEnd) {\r\n        var _this = this;\r\n        // If there are no listeners, the app probably has a bug where it's\r\n        // starting an animation before the associated element is mounted.\r\n        // Complete the animation immediately by updating to the end value\r\n        // and caling the onEnd callback.\r\n        if (this._listeners.length === 0) {\r\n            this._updateFinalValue(toValue);\r\n            if (onEnd) {\r\n                onEnd({ finished: false });\r\n            }\r\n            return;\r\n        }\r\n        // Only call onEnd once for a series of listeners.\r\n        var onEndCalled = false;\r\n        var onEndWrapper = function (result) {\r\n            if (onEndCalled) {\r\n                return;\r\n            }\r\n            onEndCalled = true;\r\n            onEnd(result);\r\n        };\r\n        _.each(this._listeners, function (listener) {\r\n            listener.startTransition(_this, _this._getOutputValue(), _this._getInterpolatedValue(toValue), duration, easing, delay, onEndWrapper);\r\n        });\r\n    };\r\n    // Stop animation.\r\n    Value.prototype._stopTransition = function () {\r\n        var _this = this;\r\n        _.each(this._listeners, function (listener) {\r\n            var updatedValue = listener.stopTransition(_this);\r\n            if (updatedValue !== undefined) {\r\n                _this._updateFinalValue(updatedValue);\r\n            }\r\n        });\r\n    };\r\n    // After an animation is stopped or completed, updates\r\n    // the final value.\r\n    Value.prototype._updateFinalValue = function (value) {\r\n        this.setValue(value);\r\n    };\r\n    return Value;\r\n}(RX.Types.AnimatedValue));\r\nexports.Value = Value;\r\nvar InterpolatedValue = /** @class */ (function (_super) {\r\n    __extends(InterpolatedValue, _super);\r\n    function InterpolatedValue(_config, rootValue) {\r\n        var _this = _super.call(this, rootValue._getOutputValue()) || this;\r\n        _this._config = _config;\r\n        if (!_this._config || !_this._config.inputRange || !_this._config.outputRange ||\r\n            _this._config.inputRange.length < 2 || _this._config.outputRange.length < 2 ||\r\n            _this._config.inputRange.length !== _this._config.outputRange.length) {\r\n            throw new Error('The interpolation config is invalid. Input and output arrays must be same length.');\r\n        }\r\n        var newInterpolationConfig = {};\r\n        _.each(_this._config.inputRange, function (key, index) {\r\n            newInterpolationConfig[key] = _this._config.outputRange[index];\r\n        });\r\n        _this._interpolationConfig = newInterpolationConfig;\r\n        rootValue._addListener({\r\n            setValue: function (valueObject, newValue) {\r\n                _this.setValue(valueObject._getOutputValue());\r\n            },\r\n            startTransition: function (valueObject, from, toValue, duration, easing, delay, onEnd) {\r\n                _this._startTransition(toValue, duration, easing, delay, onEnd);\r\n            },\r\n            stopTransition: function (valueObject) {\r\n                _this._stopTransition();\r\n                return undefined;\r\n            },\r\n        });\r\n        return _this;\r\n    }\r\n    InterpolatedValue.prototype._startTransition = function (toValue, duration, easing, delay, onEnd) {\r\n        // This API doesn't currently support more than two elements in the\r\n        // interpolation array. Supporting this in the web would require the\r\n        // use of JS-driven animations or keyframes, both of which are prohibitively\r\n        // expensive from a performance and responsiveness perspective.\r\n        if (this._config.inputRange.length !== 2) {\r\n            if (AppConfig_1.default.isDevelopmentMode()) {\r\n                console.log('Web implementation of interpolate API currently supports only two interpolation values.');\r\n            }\r\n        }\r\n        _super.prototype._startTransition.call(this, toValue, duration, easing, delay, onEnd);\r\n    };\r\n    InterpolatedValue.prototype._convertValueToNumeric = function (inputVal) {\r\n        if (_.isNumber(inputVal)) {\r\n            return inputVal;\r\n        }\r\n        return parseInt(inputVal, 10);\r\n    };\r\n    InterpolatedValue.prototype._addUnitsToNumericValue = function (value, templateValue) {\r\n        if (_.isNumber(templateValue)) {\r\n            return value;\r\n        }\r\n        // Does the template contain any of the common units?\r\n        var templateString = templateValue;\r\n        var commonUnits = ['deg', 'grad', 'rad'];\r\n        for (var _i = 0, commonUnits_1 = commonUnits; _i < commonUnits_1.length; _i++) {\r\n            var unit = commonUnits_1[_i];\r\n            if (templateString.indexOf(unit) > 0) {\r\n                return value.toString() + unit;\r\n            }\r\n        }\r\n        return value;\r\n    };\r\n    InterpolatedValue.prototype._getInterpolatedValue = function (inputVal) {\r\n        var _this = this;\r\n        if (!this._interpolationConfig) {\r\n            throw new Error('There is no interpolation config but one is required');\r\n        }\r\n        var numericInputValue = this._convertValueToNumeric(inputVal);\r\n        var outputValues = this._config.outputRange.map(function (value) { return _this._convertValueToNumeric(value); });\r\n        if (this._interpolationConfig[numericInputValue]) {\r\n            return this._interpolationConfig[numericInputValue];\r\n        }\r\n        if (inputVal < this._config.inputRange[0]) {\r\n            return outputValues[0];\r\n        }\r\n        for (var i = 1; i < this._config.inputRange.length; i++) {\r\n            if (inputVal < this._config.inputRange[i]) {\r\n                var ratio = (numericInputValue - this._config.inputRange[i - 1]) /\r\n                    (this._config.inputRange[i] - this._config.inputRange[i - 1]);\r\n                return this._addUnitsToNumericValue(this._config.outputRange[i] * ratio +\r\n                    this._config.outputRange[i - 1] * (1 - ratio), inputVal);\r\n            }\r\n        }\r\n        return this._addUnitsToNumericValue(outputValues[this._config.inputRange.length - 1], inputVal);\r\n    };\r\n    InterpolatedValue.prototype._isInterpolated = function () {\r\n        return true;\r\n    };\r\n    return InterpolatedValue;\r\n}(Value));\r\nexports.InterpolatedValue = InterpolatedValue;\r\nexports.timing = function (value, config) {\r\n    if (!value || !config) {\r\n        throw new Error('Timing animation requires value and config');\r\n    }\r\n    var stopLooping = false;\r\n    return {\r\n        start: function (onEnd) {\r\n            var animate = function () {\r\n                if (config.loop) {\r\n                    value.setValue(config.loop.restartFrom);\r\n                }\r\n                var easing = config.easing || Easing_1.default.Default();\r\n                var duration = config.duration !== undefined ? config.duration : 500;\r\n                var delay = config.delay || 0;\r\n                value._startTransition(config.toValue, duration, easing.cssName, delay, function (result) {\r\n                    // Restart the loop?\r\n                    if (config.loop && !stopLooping) {\r\n                        animate();\r\n                    }\r\n                    else {\r\n                        value._updateFinalValue(config.toValue);\r\n                    }\r\n                    if (onEnd) {\r\n                        onEnd(result);\r\n                    }\r\n                });\r\n            };\r\n            // Trigger animation loop\r\n            animate();\r\n        },\r\n        stop: function () {\r\n            stopLooping = true;\r\n            value._stopTransition();\r\n        },\r\n    };\r\n};\r\nexports.sequence = function (animations) {\r\n    if (!animations) {\r\n        throw new Error('Sequence animation requires a list of animations');\r\n    }\r\n    var hasBeenStopped = false;\r\n    var doneCount = 0;\r\n    var result = {\r\n        start: function (onEnd) {\r\n            if (!animations || animations.length === 0) {\r\n                throw new Error('No animations were passed to the animated sequence API');\r\n            }\r\n            var executeNext = function () {\r\n                doneCount++;\r\n                var isFinished = doneCount === animations.length;\r\n                if (hasBeenStopped || isFinished) {\r\n                    doneCount = 0;\r\n                    hasBeenStopped = false;\r\n                    if (onEnd) {\r\n                        onEnd({ finished: isFinished });\r\n                    }\r\n                    return;\r\n                }\r\n                animations[doneCount].start(executeNext);\r\n            };\r\n            animations[doneCount].start(executeNext);\r\n        },\r\n        stop: function () {\r\n            if (doneCount < animations.length) {\r\n                doneCount = 0;\r\n                hasBeenStopped = true;\r\n                animations[doneCount].stop();\r\n            }\r\n        },\r\n    };\r\n    return result;\r\n};\r\nexports.parallel = function (animations) {\r\n    if (!animations) {\r\n        throw new Error('Parallel animation requires a list of animations');\r\n    }\r\n    // Variable to make sure we only call stop() at most once\r\n    var hasBeenStopped = false;\r\n    var doneCount = 0;\r\n    var result = {\r\n        start: function (onEnd) {\r\n            if (!animations || animations.length === 0) {\r\n                throw new Error('No animations were passed to the animated parallel API');\r\n            }\r\n            // Walk through animations and start all as soon as possible.\r\n            animations.forEach(function (animation, id) {\r\n                animation.start(function (animationResult) {\r\n                    doneCount++;\r\n                    var isFinished = doneCount === animations.length;\r\n                    if (hasBeenStopped || isFinished) {\r\n                        doneCount = 0;\r\n                        hasBeenStopped = false;\r\n                        if (onEnd) {\r\n                            onEnd({ finished: isFinished });\r\n                        }\r\n                        return;\r\n                    }\r\n                });\r\n            });\r\n        },\r\n        stop: function () {\r\n            doneCount = 0;\r\n            hasBeenStopped = true;\r\n            animations.forEach(function (animation) {\r\n                animation.stop();\r\n            });\r\n        },\r\n    };\r\n    return result;\r\n};\r\n// Function for creating wrapper AnimatedComponent around passed in component\r\nfunction createAnimatedComponent(Component) {\r\n    var AnimatedComponentGenerated = /** @class */ (function (_super) {\r\n        __extends(AnimatedComponentGenerated, _super);\r\n        function AnimatedComponentGenerated(props) {\r\n            var _this = _super.call(this, props) || this;\r\n            _this._mountedComponent = null;\r\n            _this._onMount = function (component) {\r\n                _this._mountedComponent = component;\r\n            };\r\n            _this._animatedAttributes = {};\r\n            _this._animatedTransforms = {};\r\n            _this._updateStyles(props);\r\n            return _this;\r\n        }\r\n        AnimatedComponentGenerated.prototype.setNativeProps = function (props) {\r\n            if (AppConfig_1.default.isDevelopmentMode()) {\r\n                console.error('setNativeProps not supported on web');\r\n            }\r\n        };\r\n        AnimatedComponentGenerated.prototype.UNSAFE_componentWillReceiveProps = function (props) {\r\n            this._updateStyles(props);\r\n        };\r\n        AnimatedComponentGenerated.prototype.setValue = function (valueObject, newValue) {\r\n            // We should never get here if the component isn't mounted,\r\n            // but we'll add this additional protection.\r\n            if (!this._mountedComponent) {\r\n                return;\r\n            }\r\n            var attrib = this._findAnimatedAttributeByValue(this._animatedAttributes, valueObject);\r\n            if (attrib) {\r\n                var domNode = this._getDomNode();\r\n                if (domNode) {\r\n                    var cssValue = this._generateCssAttributeValue(attrib, valueObject._getOutputValue());\r\n                    domNode.style[attrib] = cssValue;\r\n                }\r\n                return;\r\n            }\r\n            var transform = this._findAnimatedAttributeByValue(this._animatedTransforms, valueObject);\r\n            if (transform) {\r\n                var domNode = this._getDomNode();\r\n                if (domNode) {\r\n                    domNode.style.transform = this._generateCssTransformList(true);\r\n                }\r\n            }\r\n        };\r\n        AnimatedComponentGenerated.prototype.startTransition = function (valueObject, fromValue, toValue, duration, easing, delay, onEnd) {\r\n            // We should never get here if the component isn't mounted,\r\n            // but we'll add this additional protection.\r\n            if (!this._mountedComponent) {\r\n                return;\r\n            }\r\n            var updateTransition = false;\r\n            var attrib = this._findAnimatedAttributeByValue(this._animatedAttributes, valueObject);\r\n            if (attrib) {\r\n                if (this._animatedAttributes[attrib].activeTransition) {\r\n                    if (AppConfig_1.default.isDevelopmentMode()) {\r\n                        console.error('Animation started while animation was already pending');\r\n                    }\r\n                }\r\n                this._animatedAttributes[attrib].activeTransition = {\r\n                    property: Styles_1.default.convertJsToCssStyle(attrib),\r\n                    from: this._generateCssAttributeValue(attrib, fromValue),\r\n                    to: this._generateCssAttributeValue(attrib, toValue),\r\n                    duration: duration,\r\n                    timing: easing,\r\n                    delay: delay,\r\n                    toValue: toValue,\r\n                    onEnd: onEnd,\r\n                };\r\n                updateTransition = true;\r\n            }\r\n            var transform = this._findAnimatedAttributeByValue(this._animatedTransforms, valueObject);\r\n            if (transform) {\r\n                if (this._animatedTransforms[transform].activeTransition) {\r\n                    if (AppConfig_1.default.isDevelopmentMode()) {\r\n                        console.error('Animation started while animation was already pending');\r\n                    }\r\n                }\r\n                this._animatedTransforms[transform].activeTransition = {\r\n                    property: transform,\r\n                    from: fromValue,\r\n                    to: toValue,\r\n                    duration: duration,\r\n                    timing: easing,\r\n                    delay: delay,\r\n                    toValue: toValue,\r\n                    onEnd: onEnd,\r\n                };\r\n                updateTransition = true;\r\n            }\r\n            if (updateTransition) {\r\n                this._updateTransition();\r\n            }\r\n        };\r\n        // Stops a pending transition, returning the value at the current time.\r\n        AnimatedComponentGenerated.prototype.stopTransition = function (valueObject) {\r\n            // We should never get here if the component isn't mounted,\r\n            // but we'll add this additional protection.\r\n            if (!this._mountedComponent) {\r\n                return;\r\n            }\r\n            var partialValue;\r\n            var stoppedTransition;\r\n            var updateTransition = false;\r\n            var attrib = this._findAnimatedAttributeByValue(this._animatedAttributes, valueObject);\r\n            if (attrib) {\r\n                var activeTransition = this._animatedAttributes[attrib].activeTransition;\r\n                if (activeTransition) {\r\n                    partialValue = activeTransition.toValue;\r\n                    // We don't currently support updating to an intermediate\r\n                    // value for interpolated values because this would involve\r\n                    // mapping the interpolated value in reverse. Instead, we'll\r\n                    // simply update it to the \"toValue\".\r\n                    if (!valueObject._isInterpolated()) {\r\n                        var domNode = this._getDomNode();\r\n                        if (domNode) {\r\n                            var computedStyle = window.getComputedStyle(domNode, undefined);\r\n                            if (computedStyle && computedStyle[attrib]) {\r\n                                partialValue = computedStyle[attrib];\r\n                            }\r\n                        }\r\n                    }\r\n                    stoppedTransition = this._animatedAttributes[attrib].activeTransition;\r\n                    delete this._animatedAttributes[attrib].activeTransition;\r\n                    updateTransition = true;\r\n                }\r\n            }\r\n            else {\r\n                var transform = this._findAnimatedAttributeByValue(this._animatedTransforms, valueObject);\r\n                if (transform) {\r\n                    var activeTransition = this._animatedTransforms[transform].activeTransition;\r\n                    if (activeTransition) {\r\n                        // We don't currently support updating to an intermediate value\r\n                        // for transform values. This is because getComputedStyle\r\n                        // returns a transform matrix for 'transform'. To implement this, we'd\r\n                        // need to convert the matrix back to a rotation, scale, etc.\r\n                        partialValue = activeTransition.toValue;\r\n                        stoppedTransition = this._animatedTransforms[transform].activeTransition;\r\n                        delete this._animatedTransforms[transform].activeTransition;\r\n                        updateTransition = true;\r\n                    }\r\n                }\r\n            }\r\n            if (stoppedTransition && stoppedTransition.onEnd) {\r\n                stoppedTransition.onEnd({ finished: false });\r\n            }\r\n            if (updateTransition) {\r\n                this._updateTransition();\r\n            }\r\n            return partialValue;\r\n        };\r\n        AnimatedComponentGenerated.prototype._getDomNode = function () {\r\n            return ReactDOM.findDOMNode(this._mountedComponent);\r\n        };\r\n        // Looks for the specified value object in the specified map. Returns\r\n        // the key for the map (i.e. the attribute name) if found.\r\n        AnimatedComponentGenerated.prototype._findAnimatedAttributeByValue = function (map, valueObj) {\r\n            var keys = _.keys(map);\r\n            var index = _.findIndex(keys, function (key) { return map[key].valueObject === valueObj; });\r\n            return index >= 0 ? keys[index] : undefined;\r\n        };\r\n        // Updates the \"transform\" CSS attribute for the element to reflect all\r\n        // active transitions.\r\n        AnimatedComponentGenerated.prototype._updateTransition = function () {\r\n            var _this = this;\r\n            // We should never get here if the component isn't mounted,\r\n            // but we'll add this additional protection.\r\n            if (!this._mountedComponent) {\r\n                return;\r\n            }\r\n            var activeTransitions = [];\r\n            _.each(this._animatedAttributes, function (attrib) {\r\n                if (attrib.activeTransition) {\r\n                    activeTransitions.push(attrib.activeTransition);\r\n                }\r\n            });\r\n            // If there are any transform transitions, we need to combine\r\n            // these into a single transition. That means we can't specify\r\n            // different durations, delays or easing functions for each. That's\r\n            // an unfortunate limitation of CSS.\r\n            var keys = _.keys(this._animatedTransforms);\r\n            var index = _.findIndex(keys, function (key) { return !!_this._animatedTransforms[key].activeTransition; });\r\n            if (index >= 0) {\r\n                var transformTransition = this._animatedTransforms[keys[index]].activeTransition;\r\n                activeTransitions.push({\r\n                    property: 'transform',\r\n                    from: this._generateCssTransformList(false),\r\n                    to: this._generateCssTransformList(true),\r\n                    duration: transformTransition.duration,\r\n                    timing: transformTransition.timing,\r\n                    delay: transformTransition.delay,\r\n                });\r\n            }\r\n            if (activeTransitions.length > 0) {\r\n                var domNode = this._getDomNode();\r\n                if (domNode) {\r\n                    executeTransition_1.executeTransition(domNode, activeTransitions, function () {\r\n                        // Clear all of the active transitions and invoke the onEnd callbacks.\r\n                        var completeTransitions = [];\r\n                        _.each(_this._animatedAttributes, function (attrib) {\r\n                            if (attrib.activeTransition) {\r\n                                completeTransitions.push(attrib.activeTransition);\r\n                                delete attrib.activeTransition;\r\n                            }\r\n                        });\r\n                        _.each(_this._animatedTransforms, function (transform) {\r\n                            if (transform.activeTransition) {\r\n                                completeTransitions.push(transform.activeTransition);\r\n                                delete transform.activeTransition;\r\n                            }\r\n                        });\r\n                        _.each(completeTransitions, function (transition) {\r\n                            if (transition.onEnd) {\r\n                                transition.onEnd({ finished: true });\r\n                            }\r\n                        });\r\n                    });\r\n                }\r\n            }\r\n        };\r\n        // Generates the CSS value for the specified attribute given\r\n        // an animated value object.\r\n        AnimatedComponentGenerated.prototype._generateCssAttributeValue = function (attrib, newValue) {\r\n            // If the value is a raw number, append the default units.\r\n            // If it's a string, we assume the caller has specified the units.\r\n            if (typeof newValue === 'number') {\r\n                newValue = newValue + animatedPropUnits[attrib];\r\n            }\r\n            return newValue;\r\n        };\r\n        AnimatedComponentGenerated.prototype._generateCssTransformValue = function (transform, newValue) {\r\n            // If the value is a raw number, append the default units.\r\n            // If it's a string, we assume the caller has specified the units.\r\n            if (typeof newValue === 'number') {\r\n                newValue = newValue + animatedPropUnits[transform];\r\n            }\r\n            return newValue;\r\n        };\r\n        // Regenerates the list of transforms, combining all static and animated transforms.\r\n        AnimatedComponentGenerated.prototype._generateCssTransformList = function (useActiveValues) {\r\n            var _this = this;\r\n            var transformList = [];\r\n            _.each(this._staticTransforms, function (value, transform) {\r\n                transformList.push(transform + '(' + value + ')');\r\n            });\r\n            _.each(this._animatedTransforms, function (value, transform) {\r\n                var newValue = useActiveValues && value.activeTransition ?\r\n                    value.activeTransition.to : value.valueObject._getOutputValue();\r\n                transformList.push(transform + '(' + _this._generateCssTransformValue(transform, newValue) + ')');\r\n            });\r\n            return transformList.join(' ');\r\n        };\r\n        // Typing of `any` on StyleRuleSet isn't desirable, but there's not accurate typings that can be used to represent\r\n        // our merging of web/RX styles here here\r\n        AnimatedComponentGenerated.prototype._updateStyles = function (props) {\r\n            var _this = this;\r\n            this._propsWithoutStyle = _.omit(props, 'style');\r\n            var rawStyles = Styles_1.default.combine(props.style || {});\r\n            this._processedStyle = {};\r\n            var newAnimatedAttributes = {};\r\n            for (var attrib in rawStyles) {\r\n                // Handle transforms separately.\r\n                if (attrib === 'staticTransforms' || attrib === 'animatedTransforms') {\r\n                    continue;\r\n                }\r\n                // Is this a dynamic (animated) value?\r\n                if (rawStyles[attrib] instanceof Value) {\r\n                    var valueObj = rawStyles[attrib];\r\n                    this._processedStyle[attrib] = this._generateCssAttributeValue(attrib, valueObj._getOutputValue());\r\n                    newAnimatedAttributes[attrib] = valueObj;\r\n                }\r\n                else {\r\n                    // Copy the static style value.\r\n                    this._processedStyle[attrib] = rawStyles[attrib];\r\n                }\r\n            }\r\n            // Handle transforms, which require special processing because they need to\r\n            // be combined into a single 'transform' CSS attribute.\r\n            this._staticTransforms = rawStyles.staticTransforms || {};\r\n            var newAnimatedTransforms = rawStyles.animatedTransforms || {};\r\n            // Update this._animatedAttributes and this._animatedTransforms so they match\r\n            // the updated style.\r\n            // Remove any previous animated attributes that are no longer present\r\n            // or associated with different value objects.\r\n            _.each(this._animatedAttributes, function (value, attrib) {\r\n                if (!newAnimatedAttributes[attrib] || newAnimatedAttributes[attrib] !== value.valueObject) {\r\n                    if (value.activeTransition) {\r\n                        if (AppConfig_1.default.isDevelopmentMode()) {\r\n                            console.error('Animated style attribute removed while the animation was active');\r\n                        }\r\n                    }\r\n                    value.valueObject._removeListener(_this);\r\n                    delete _this._animatedAttributes[attrib];\r\n                }\r\n            });\r\n            // Add new animated attributes.\r\n            _.each(newAnimatedAttributes, function (value, attrib) {\r\n                if (!_this._animatedAttributes[attrib]) {\r\n                    _this._animatedAttributes[attrib] = { valueObject: value };\r\n                    if (_this._mountedComponent) {\r\n                        value._addListener(_this);\r\n                    }\r\n                }\r\n            });\r\n            // Remove any previous animated transforms that are no longer present\r\n            // or associated with different value objects.\r\n            _.each(this._animatedTransforms, function (value, transform) {\r\n                if (!newAnimatedTransforms[transform] || newAnimatedTransforms[transform] !== value.valueObject) {\r\n                    if (value.activeTransition) {\r\n                        if (AppConfig_1.default.isDevelopmentMode()) {\r\n                            console.warn('Should not remove an animated transform attribute while the animation is active');\r\n                        }\r\n                    }\r\n                    value.valueObject._removeListener(_this);\r\n                    delete _this._animatedTransforms[transform];\r\n                }\r\n            });\r\n            // Add new animated transforms.\r\n            _.each(newAnimatedTransforms, function (value, transform) {\r\n                if (!_this._animatedTransforms[transform]) {\r\n                    _this._animatedTransforms[transform] = { valueObject: value };\r\n                    if (_this._mountedComponent) {\r\n                        value._addListener(_this);\r\n                    }\r\n                }\r\n            });\r\n            // Update the transform attribute in this._processedStyle.\r\n            var transformList = this._generateCssTransformList(true);\r\n            if (transformList) {\r\n                this._processedStyle.transform = transformList;\r\n            }\r\n        };\r\n        AnimatedComponentGenerated.prototype.componentDidMount = function () {\r\n            var _this = this;\r\n            _.each(this._animatedAttributes, function (value) {\r\n                value.valueObject._addListener(_this);\r\n            });\r\n            _.each(this._animatedTransforms, function (value) {\r\n                value.valueObject._addListener(_this);\r\n            });\r\n        };\r\n        AnimatedComponentGenerated.prototype.componentWillUnmount = function () {\r\n            var _this = this;\r\n            _.each(this._animatedAttributes, function (value) {\r\n                value.valueObject._removeListener(_this);\r\n            });\r\n            this._animatedAttributes = {};\r\n            _.each(this._animatedTransforms, function (value) {\r\n                value.valueObject._removeListener(_this);\r\n            });\r\n            this._animatedTransforms = {};\r\n        };\r\n        AnimatedComponentGenerated.prototype.focus = function () {\r\n            if (this._mountedComponent && this._mountedComponent.focus) {\r\n                this._mountedComponent.focus();\r\n            }\r\n        };\r\n        AnimatedComponentGenerated.prototype.requestFocus = function () {\r\n            if (this._mountedComponent && this._mountedComponent.requestFocus) {\r\n                this._mountedComponent.requestFocus();\r\n            }\r\n        };\r\n        AnimatedComponentGenerated.prototype.blur = function () {\r\n            if (this._mountedComponent && this._mountedComponent.blur) {\r\n                this._mountedComponent.blur();\r\n            }\r\n        };\r\n        AnimatedComponentGenerated.prototype.setFocusRestricted = function (restricted) {\r\n            if (this._mountedComponent && this._mountedComponent.setFocusRestricted) {\r\n                this._mountedComponent.setFocusRestricted(restricted);\r\n            }\r\n        };\r\n        AnimatedComponentGenerated.prototype.setFocusLimited = function (limited) {\r\n            if (this._mountedComponent && this._mountedComponent.setFocusLimited) {\r\n                this._mountedComponent.setFocusLimited(limited);\r\n            }\r\n        };\r\n        AnimatedComponentGenerated.prototype.render = function () {\r\n            return (React.createElement(Component, __assign({ style: this._processedStyle }, this._propsWithoutStyle, { ref: this._onMount }), this.props.children));\r\n        };\r\n        // Update the component's display name for easy debugging in react devtools extension\r\n        AnimatedComponentGenerated.displayName = \"Animated.\" + (Component.displayName || Component.name || 'Component');\r\n        return AnimatedComponentGenerated;\r\n    }(React.Component));\r\n    return AnimatedComponentGenerated;\r\n}\r\nexports.Image = createAnimatedComponent(Image_1.default);\r\nexports.Text = createAnimatedComponent(Text_1.default);\r\nexports.TextInput = createAnimatedComponent(TextInput_1.default);\r\nexports.View = createAnimatedComponent(View_1.default);\r\nexports.createValue = function (initialValue) {\r\n    return new Value(initialValue);\r\n};\r\nexports.interpolate = function (value, inputRange, outputRange) {\r\n    return value.interpolate({ inputRange: inputRange, outputRange: outputRange });\r\n};\r\n"]},"metadata":{},"sourceType":"script"}